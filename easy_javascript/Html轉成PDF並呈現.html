<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HTML to PDF</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
</head>
<body>
  <div id="content">
    <h1>將我轉成 PDF！</h1>
    <p>這段文字會轉到 PDF 中。</p>
  </div>
  <button id="generate">生成 PDF</button>
  <button id="generateAndPrint">生成 PDF 並列印 </button>

  <script>
    // 下載成PDF
    document.getElementById('generate').addEventListener('click', () => {
        const element = document.getElementById('content');
        html2pdf().from(element).save();
    });

    document.getElementById('generateAndPrint').addEventListener('click', () => {
        const element = document.getElementById('content');
        html2pdf().from(element).toPdf().get('pdf').then((pdf) => {
            const pdfData = pdf.output('dataurl');
            const newWindow = window.open();
            newWindow.document.write('<iframe id="pdfFrame" src="' + pdfData + '" style="width:100%;height:100%;border:none;"></iframe>');
        
            // 確保 iframe 加載完成後再處理
            // 備註：目前還是無法解決 可以直接列印。 這邊會直接列印，但就是預覽圖示很明顯就知道是錯的(看來只能手動列印)
            const iframe = newWindow.document.getElementById('pdfFrame');
            iframe.onload = () => {
              newWindow.document.close(); // 確保完成後關閉文檔流
              newWindow.focus(); // 將焦點移至新視窗
              newWindow.print(); // 觸發列印
            };
        });
    });
  </script>
</body>
</html>